##task24 : SQL injection #Web_for_pentester - level 1

 ###**Các công việc cần làm**
 
 - [ **Làm level 1 - SQL injection**](#1)
 
 - [**Lập trình php, mô phỏng lại lỗ hỏng của level**](#2)
 
 - [**Lập trình php, khắc phục lỗi sql injection của level 1**](#3)
 
<a name="1"></a>
####1:Làm level 1 - SQL injection
<a name="2"></a> 
 ####2:Lập trình php, mô phỏng lại lỗ hỏng của level 
 
 dạng tấn công này là Dạng tấn công vượt qua kiểm tra đăng nhập , bằng cách thực hiện câu lệnh truy vấn 
 `SELECT * FROM USERS WHERE NAME ='' OR ''='' and PASSWORD= '' OR ''=''`
 
 **code PHP**
 
 ```
 <?php

	
	if (isset($_POST["btn_submit"])) {
		
		$username = $_POST["username"];
		$password = $_POST["password"];
	
		if ($username == "" || $password =="") {
			echo "username hoặc password bạn không được để trống!";
		}else{
			$sql = "select * from users where username = '$username' and password = '$password' ";
			$query = mysqli_query($conn,$sql);
			$num_rows = mysqli_num_rows($query);
			if ($num_rows==0) {
				echo "tên đăng nhập hoặc mật khẩu không đúng !";
			}else{
				
				$_SESSION['username'] = $username;// Thực thi hành động sau khi lưu thông tin vào session
                
            header('Location: index.php'); // chuyển hướng trang web tới một trang gọi là index.php
			}
		}
	}
?>
```
<a name="3"></a>
####Lập trình php, khắc phục lỗi sql injection của level 1

ta có thể thêm `strip_tags` và `addslashes` vào trước usn và pw để làm sạch thông tin,xóa bỏ các tag html, ký tự đặc biệt  

```
<?php
	

	if (isset($_POST["btn_submit"]))	// Kiểm tra nếu người dùng đã ân nút đăng nhập thì mới xử lý
  {
		
		$username = $_POST["username"];// lấy thông tin người dùng
		$password = $_POST["password"];
		
		
		$username = strip_tags($username);//làm sạch thông tin, xóa bỏ các tag html, ký tự đặc biệt 
		$username = addslashes($username);//mà người dùng cố tình thêm vào để tấn công theo phương thức sql injection
		$password = strip_tags($password);
		$password = addslashes($password);
		if ($username == "" || $password =="") {
			echo "username hoặc password bạn không được để trống!";
		}else{
			$sql = "select * from users where username = '$username' and password = '$password' ";
			$query = mysqli_query($conn,$sql);
			$num_rows = mysqli_num_rows($query);
			if ($num_rows==0) {
				echo "tên đăng nhập hoặc mật khẩu không đúng !";
			}else{
				//tiến hành lưu tên đăng nhập vào session để tiện xử lý sau này
				$_SESSION['username'] = $username;  // Thực thi hành động sau khi lưu thông tin vào session
              
               
                header('Location: index.php'); // chuyển hướng trang web tới một trang gọi là index.php
			}
		}
	}
?>
```
